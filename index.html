<!DOCTYPE html>
<html>
    <head>
    <meta charset="UTF-8">
    <title>Survey questions</title>

    <script src="https://web-experiments.lab.hum.uu.nl/jspsych/6.1.0/jspsych.js"></script>
    <script src="https://web-experiments.lab.hum.uu.nl/jspsych/6.1.0/plugins/jspsych-survey-html-form.js"></script>
    <script src="https://web-experiments.lab.hum.uu.nl/jspsych/6.1.0/plugins/jspsych-survey-multi-choice.js"></script>
    <script src="https://web-experiments.lab.hum.uu.nl/jspsych/6.1.0/plugins/jspsych-survey-text.js"></script>
    <script src="https://web-experiments.lab.hum.uu.nl/jspsych/6.1.0/plugins/jspsych-survey-multi-select.js"></script>

    <!-- Generic jspsych style sheets -->
    <link href="./css/uu-style.css" rel="stylesheet" type="text/css"/>

    <!-- Uil OTS libraries -->
    <script src="https://web-experiments.lab.hum.uu.nl/jspsych/uil-utils/dev/jspsych-uil-utils.js"></script>
    <style>
        
        input,
        label {
            margin: .4rem 0;
        }

        span::after {
          padding-left: 5px;
        }

        input:invalid + span::after {
          content: '✖';
        }

        input:valid+span::after {
          content: '✓';
        }
        
    </style>
    </head>
    <body></body>
    <script>

        ACCESS_KEY = 'blergh';

        //native language
        //monolingual/not
        //dyslectic/not
        //date of birth
        //sex
        //left/right handed


        //honestly, it's probably better to do this type of thing in Qualtrics or custom external html, but well
        // let's start simple, the problem is that we want date pickers from native html/js and input validation
        
        //https://stackoverflow.com/questions/3217492/list-of-language-codes-in-yaml-or-json
        //https://www.localeplanet.com/api/auto/langmap.html?lang=es,en,fr
        //https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input/date

        //     <link href="https://web-experiments.lab.hum.uu.nl/jspsych/6.1.0/css/jspsych.css" rel="stylesheet" type="text/css"/>

        // client-side input validation will be darn difficult to regexp...
        // at least for a native langage text field...

        //  <form>
        //   <label for="choose">Would you prefer a banana or a cherry?</label>
        //   <input id="choose" name="i_like" required pattern="[Bb]anana|[Cc]herry">
        //   <button>Submit</button>
        // </form>


        var native_language_trial_text = {
            type: 'survey-text',
            questions: [
                {
                    prompt: "What is your native language?", 
                    name: 'native_language'
                }
            ],
        };

        var birthdate_trial_html_1 = {
            type: 'survey-html-form',
            preamble: '<p>survey stuff</p>',
            html: '<label for="birth">When were you born?</label>' +
                  '<input type="date" id="birth" name="birthdate" ' + 
                  'value="1997-07-23" min="1933-01-01" max="2018-12-31" required>' + 
                  '<span class="validity"></span>'
        }

        var birthdate_trial_html_2 = {
            type: 'survey-html-form',
            preamble: '<p>When were you born? (no need to be exact to the day)</p>',
            html: '<input type="date" id="birth" name="birthdate" ' + 
                  'value="1997-07-23" min="1933-01-01" max="2018-12-31" required>' + 
                  '<span class="validity"></span>'
        }

        var input_valid_text_html = {
            type: 'survey-html-form',
            preamble: '<p>Where were you born? (input validation for: BananaRepublic or cherryColaRado? )</p>',
            html: '<input type="text" id="birth_country" name="birthcountry" required pattern="[Bb]anana|[Cc]herry">' + 
                  '<span class="validity"></span>'
        }
        
        var input_valid_number_html = {
            type: 'survey-html-form',
            preamble: '<p>In what year were you born (input validation for between 1919 and 2019) </p>',
            html: '<input type="number" id="birth_year" name="birth_year" placeholder=1999 min=1919 max=2019 required>' + 
                  '<span class="validity"></span><BR>'
        }

        var input_valid_name_html = {
            type: 'survey-html-form',
            preamble: '<p>What is your native language?(input pattern now at: "[a-zA-Z]+"</p>',
            html: '<label for="native_language">My native language is: </label>' + 
                 '<input type="text" id="language" name="native_language" pattern="[a-zA-Z]+" placeholder="Dutch" required>' +
                  '<span class="validity"></span><BR>'
        }

//   <label for="name">Name: *</label>
//   <input type="text" id="name" name="name" pattern="[a-zA-Z]+" placeholder="Monty" required>
//   <br>

        // default options
        var bilingual_options = ["No","Yes"];
        var dyslex_options = ["No", "Yes"];
        var gender_options = ["Female", "Male"];
        var hand_options = ["Left handed", "Right handed"];

        // this is the most usable plugin, since it has input validation
        // maybe make a bunch of age categories
        var multi_choice_block = {
            type: 'survey-multi-choice',
            questions: [
                {
                    prompt: "Have you been raised speaking multiple languages at home? (since when you were an infant)",
                    name: 'Multilingual', 
                    options: bilingual_options, 
                    required:true, 
                    horizontal: true
                }, 
                {
                    prompt: "Are you dyslexic?", 
                    name: 'Dyslexic',
                    options: dyslex_options,
                    required: true,
                    horizontal: true
                },
                {
                    prompt: "What gender are you?",
                    name:'Gender',
                    options: gender_options,
                    required: true,
                    horizontal: true
                },
                {
                    prompt: "What is your hand preference?", name:'HandPreference', options: hand_options, required: true, horizontal: true
                }
            ],
        };

        var multi_question_birth_year_month = {
            type: 'survey-text',
            questions: [
                {
                    prompt: "In what year were you born?", 
                    name: 'BirthYear',

                },
                {
                    prompt: "In what month (1-12) were you born?", 
                    name: 'BirthMonth'
                }
            ],
        };


        timeline = [];

        //timeline.push(input_valid_text_html);
        timeline.push(input_valid_number_html);
        timeline.push(input_valid_name_html);
        
        timeline.push(native_language_trial_text);
        timeline.push(multi_question_birth_year_month);
        timeline.push(multi_choice_block);

        jsPsych.init({
            timeline: timeline,
            show_preload_progress_bar: false,
            use_webaudio: false,
            exclusions: {
                min_width: 800,
                min_height: 600
            },
            on_finish: function() {
                uil.saveData(ACCESS_KEY, true);
            }
        })

    </script>
</html>

